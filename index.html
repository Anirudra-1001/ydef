<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MIZ Positive Vibes Engine</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
margin:0;
font-family:Poppins, sans-serif;
background:linear-gradient(-45deg,#4facfe,#00f2fe,#43e97b,#38f9d7);
background-size:400% 400%;
animation:gradient 10s ease infinite;
color:white;
}

@keyframes gradient{
0%{background-position:0% 50%;}
50%{background-position:100% 50%;}
100%{background-position:0% 50%;}
}

.container{
max-width:850px;
margin:40px auto;
background:rgba(255,255,255,0.15);
backdrop-filter:blur(15px);
padding:25px;
border-radius:20px;
box-shadow:0 15px 40px rgba(0,0,0,0.3);
}

input,textarea{
width:100%;
padding:10px;
margin:8px 0;
border:none;
border-radius:10px;
}

button{
padding:10px;
border:none;
border-radius:10px;
background:#ff9800;
color:white;
font-weight:bold;
cursor:pointer;
}

button:hover{background:#e68900;}

.quote{
font-size:22px;
font-weight:bold;
text-align:center;
animation:glow 2s infinite alternate;
}

@keyframes glow{
from{text-shadow:0 0 10px #fff;}
to{text-shadow:0 0 20px #ff00ff,0 0 30px #00ffff;}
}

.dark{
background:#111 !important;
}

.theme1{background:linear-gradient(45deg,#ff512f,#dd2476);}
.theme2{background:linear-gradient(45deg,#00c6ff,#0072ff);}
.theme3{background:linear-gradient(45deg,#11998e,#38ef7d);}
.theme4{background:linear-gradient(45deg,#f7971e,#ffd200);}
.theme5{background:linear-gradient(45deg,#654ea3,#eaafc8);}
</style>
</head>
<body>

<div class="container" id="loginBox">
<h2>Login</h2>
<input id="loginUser" placeholder="Username">
<input type="password" id="loginPass" placeholder="Password">
<button onclick="login()">Login</button>
<button onclick="showRegister()">Register</button>
</div>

<div class="container" id="registerBox" style="display:none;">
<h2>Register</h2>
<input id="regUser" placeholder="Username">
<input type="password" id="regPass" placeholder="Password">
<button onclick="register()">Create Account</button>
<button onclick="showLogin()">Back</button>
</div>

<div class="container" id="appBox" style="display:none;">
<h2>ðŸŒŸ Positive Vibes Dashboard</h2>
<p id="welcome"></p>

<button onclick="toggleDark()">Dark Mode</button>
<button onclick="changeTheme()">Change Theme</button>

<textarea id="userText" rows="3" placeholder="Share your feelings..."></textarea>
<button onclick="generateSolution()">Get Positive Guidance</button>

<div id="result" style="margin-top:15px;"></div>

<h3>Emotion Analytics</h3>
<canvas id="emotionChart"></canvas>

<h3>Recent History</h3>
<div id="history"></div>

<button onclick="logout()" style="background:red;margin-top:15px;">Logout</button>
</div>

<script>

function encrypt(p){return btoa(p);}

function showRegister(){loginBox.style.display="none";registerBox.style.display="block";}
function showLogin(){registerBox.style.display="none";loginBox.style.display="block";}

function register(){
let u=regUser.value.trim();
let p=encrypt(regPass.value.trim());
let users=JSON.parse(localStorage.getItem("users"))||{};
users[u]=p;
localStorage.setItem("users",JSON.stringify(users));
alert("Registered Successfully ðŸŒŸ");
showLogin();
}

function login(){
let u=loginUser.value.trim();
let p=encrypt(loginPass.value.trim());
let users=JSON.parse(localStorage.getItem("users"))||{};
if(users[u]===p){
localStorage.setItem("loggedInUser",u);
initApp();
}else alert("Invalid Login");
}

function logout(){localStorage.removeItem("loggedInUser");location.reload();}

function initApp(){
loginBox.style.display="none";
appBox.style.display="block";
let user=localStorage.getItem("loggedInUser");
updateStreak();
updateXP(0);
welcome.innerHTML="Welcome <b>"+user+"</b> ðŸŒˆ Stay Positive!";
loadHistory();
loadChart();
}

window.onload=function(){if(localStorage.getItem("loggedInUser"))initApp();}

/* ---------- 100+ QUOTES DATABASE ---------- */
const spiritualQuotes={
focus:["Stay disciplined.","Effort creates destiny.","Keep pushing forward.","Small steps matter.","Stay consistent.","Focus builds success.","Dream big.","Action beats fear.","Hard work wins.","Believe in growth."],
anger:["Calm mind wins.","Pause and breathe.","Choose peace.","Respond wisely.","Forgive and grow.","Control brings power.","Silence is strength.","Stay composed.","Let go of ego.","Peace over pride."],
sad:["This too shall pass.","You are stronger than pain.","Better days are coming.","Hope is alive.","You are not alone.","Keep faith.","Healing takes time.","Stay brave.","Smile again.","Trust the journey."],
stress:["Breathe deeply.","Relax your mind.","Balance brings peace.","Slow down.","Rest and recharge.","Clear mind.","Stay centered.","Let thoughts flow.","Mindfulness works.","Calm energy."],
faith:["Trust divine timing.","Faith over fear.","Believe deeply.","Stay grateful.","Inner power grows.","Light guides you.","Devotion strengthens.","Hope never dies.","Positive energy flows.","Keep believing."]
};

/* ---------- KEYWORDS (100+) ---------- */
const emotionKeywords={
focus:["exam","study","goal","career","future","marks","college","discipline","hardwork","result","success","focus","target","aim","plan","achievement","improve","growth","practice","learn"],
anger:["anger","fight","hate","irritate","frustrate","annoyed","rage","ego","argument","shout","upset","mad","temper","complain","criticize","stressful fight","insult"],
sad:["sad","cry","lonely","breakup","hurt","pain","alone","missing","loss","fail","failure","heart","tired","weak","down","demotivated"],
stress:["stress","anxiety","pressure","tension","worry","overthinking","fear","panic","burden","confused","nervous","disturbed"],
faith:["faith","god","pray","hope","believe","devotion","spiritual","trust","divine","blessing","gratitude","positive","energy"]
};

function detectEmotion(text){
for(let e in emotionKeywords){
if(emotionKeywords[e].some(word=>text.includes(word))) return e;
}
return "faith";
}

function generateSolution(){
let text=userText.value.toLowerCase();
let emotion=detectEmotion(text);
let quotes=spiritualQuotes[emotion];
let randomQuote=quotes[Math.floor(Math.random()*quotes.length)];

result.innerHTML="<div class='quote'>"+randomQuote+"</div><br><b>Emotion:</b> "+emotion.toUpperCase()+" ðŸŒŸ";

saveHistory(text,emotion);
updateXP(10);
loadHistory();
loadChart();
}

/* ---------- XP + LEVEL ---------- */
function updateXP(points){
let user=localStorage.getItem("loggedInUser");
let xp=parseInt(localStorage.getItem("xp_"+user)||0);
xp+=points;
localStorage.setItem("xp_"+user,xp);
let level=Math.floor(xp/50);
welcome.innerHTML="Welcome <b>"+user+"</b> ðŸŒˆ | XP: "+xp+" | Level: "+level;
checkBadges(xp);
}

function checkBadges(xp){
if(xp==100) alert("ðŸ”¥ Bronze Achiever");
if(xp==300) alert("ðŸ”¥ Silver Master");
if(xp==500) alert("ðŸ”¥ Gold Champion");
}

/* ---------- STREAK ---------- */
function updateStreak(){
let user=localStorage.getItem("loggedInUser");
let today=new Date().toDateString();
let last=localStorage.getItem("last_"+user);
let streak=parseInt(localStorage.getItem("streak_"+user)||0);
if(last!==today){
streak++;
localStorage.setItem("streak_"+user,streak);
localStorage.setItem("last_"+user,today);
}
}

/* ---------- HISTORY ---------- */
function saveHistory(text,emotion){
let user=localStorage.getItem("loggedInUser");
let data=JSON.parse(localStorage.getItem("history_"+user))||[];
data.push({emotion,date:new Date().toLocaleDateString()});
localStorage.setItem("history_"+user,JSON.stringify(data));
}

function loadHistory(){
let user=localStorage.getItem("loggedInUser");
let data=JSON.parse(localStorage.getItem("history_"+user))||[];
history.innerHTML="";
data.slice(-5).reverse().forEach(d=>{
history.innerHTML+="<p>"+d.date+" - "+d.emotion+"</p>";
});
}

/* ---------- CHART ---------- */
function loadChart(){
let user=localStorage.getItem("loggedInUser");
let data=JSON.parse(localStorage.getItem("history_"+user))||[];
let count={focus:0,anger:0,sad:0,stress:0,faith:0};
data.forEach(d=>{if(count[d.emotion]!=undefined)count[d.emotion]++;});

new Chart(document.getElementById("emotionChart"),{
type:'bar',
data:{labels:Object.keys(count),
datasets:[{label:"Emotion Frequency",data:Object.values(count)}]}
});
}

/* ---------- THEME + DARK ---------- */
function toggleDark(){document.body.classList.toggle("dark");}

function changeTheme(){
let themes=["theme1","theme2","theme3","theme4","theme5"];
let random=themes[Math.floor(Math.random()*themes.length)];
document.body.className=random;
}
</script>

</body>
</html>
